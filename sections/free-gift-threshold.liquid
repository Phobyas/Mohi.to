{% comment %}
  Gift Threshold - Enhanced with Better Sample Management
  File: sections/free-gift-threshold.liquid
{% endcomment %}

{%- liquid
  assign cart_total = cart.total_price
  assign threshold = section.settings.threshold | times: 100
  assign remaining = threshold | minus: cart_total
  
  # Get sample product and variants
  assign sample_product = section.settings.sample_product
  
  if cart_total >= threshold
    assign threshold_reached = true
  else
    assign threshold_reached = false
  endif
  
  # Fix the progress calculation
  if cart_total > 0 and threshold > 0
    assign progress_percentage = cart_total | times: 100.0 | divided_by: threshold
  else
    assign progress_percentage = 0
  endif
  
  if progress_percentage > 100
    assign progress_percentage = 100
  endif
  
  if progress_percentage < 0
    assign progress_percentage = 0
  endif
  
  # Check for sample using private property to identify gift samples
  assign has_sample = false
  assign sample_info = ''
  assign sample_item_key = ''
  assign selected_product_image = ''
  assign selected_product_title = ''
  
  for item in cart.items
    if item.properties._is_free_sample == 'true'
      assign has_sample = true
      assign sample_item_key = item.key
      if item.properties['Wybrany produkt']
        assign sample_info = item.properties['Wybrany produkt']
      endif
      if item.properties._selected_product_image
        assign selected_product_image = item.properties._selected_product_image
      endif
      if item.properties._selected_product_title
        assign selected_product_title = item.properties._selected_product_title
      endif
      break
    endif
  endfor
-%}

{{ 'gift-threshold.css' | asset_url | stylesheet_tag }}

<style>
  .gift-threshold {
    background: {{ section.settings.section_bg_color }};
    color: {{ section.settings.text_color }};
    padding: {{ section.settings.section_padding }}px;
    border-radius: {{ section.settings.section_radius }}px;
    text-align: {{ section.settings.text_align }};
    margin: 20px auto;
    max-width: 1200px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  }
  
  .gift-threshold__message {
    font-size: {{ section.settings.message_font_size }}px;
    margin-bottom: 20px;
    font-weight: 500;
  }
  
  .gift-threshold__amount {
    color: {{ section.settings.accent_color }};
    font-weight: 700;
    font-size: 1.3em;
    display: inline-block;
    transition: all 0.3s ease;
  }
  
  .gift-threshold__title {
    font-size: {{ section.settings.title_font_size }}px;
    margin-bottom: 20px;
    font-weight: 700;
    color: {{ section.settings.text_color }};
  }
  
  .gift-threshold__progress {
    height: {{ section.settings.progress_height }}px;
    background: #fb923c;
    border-radius: {{ section.settings.progress_height | divided_by: 2 }}px;
    overflow: hidden;
    margin-bottom: 25px;
    position: relative;
  }
  
  .gift-threshold__progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #22c55e, #16a34a);
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: {{ section.settings.progress_height | divided_by: 2 }}px;
    position: relative;
    overflow: hidden;
  }
  
  .gift-threshold__progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmer 2s infinite;
  }
  
  @keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }
  
  .gift-threshold__search {
    width: 100%;
    max-width: 400px;
    padding: 14px 20px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 16px;
    margin: 0 auto 25px auto;
    display: block;
    transition: all 0.3s ease;
    background: white;
  }
  
  .gift-threshold__search:focus {
    outline: none;
    border-color: {{ section.settings.accent_color }};
    box-shadow: 0 0 0 3px rgba({{ section.settings.accent_color | color_to_rgb | split: ',' | first }}, {{ section.settings.accent_color | color_to_rgb | split: ',' | slice: 1, 2 | join: ',' }}, 0.1);
  }
  
  .gift-threshold__products-grid {
    display: grid;
    grid-template-columns: repeat({{ section.settings.grid_columns }}, 1fr);
    gap: 16px;
    max-height: {{ section.settings.grid_max_height }}px;
    overflow-y: auto;
    padding: 20px;
    background: #f9fafb;
    border: 1px solid #e0e0e0;
    border-radius: 10px;
    margin-bottom: 25px;
  }
  
  .gift-threshold__products-grid::-webkit-scrollbar {
    width: 8px;
  }
  
  .gift-threshold__products-grid::-webkit-scrollbar-track {
    background: #f3f4f6;
    border-radius: 4px;
  }
  
  .gift-threshold__products-grid::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 4px;
  }
  
  .gift-threshold__products-grid::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
  }
  
  .gift-threshold__product-card {
    padding: 14px;
    border: 2px solid {{ section.settings.card_border_color }};
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
    background: white;
    position: relative;
    overflow: hidden;
  }
  
  .gift-threshold__product-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, transparent, rgba({{ section.settings.card_selected_color | color_to_rgb | split: ',' | join: ',' }}, 0.05));
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  
  .gift-threshold__product-card:hover {
    border-color: {{ section.settings.card_selected_color }};
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }
  
  .gift-threshold__product-card:hover::before {
    opacity: 1;
  }
  
  .gift-threshold__product-card.selected {
    border-color: {{ section.settings.card_selected_color }};
    background: linear-gradient(135deg, #ffffff, #f0fdf4);
    box-shadow: 0 8px 24px rgba(16, 185, 129, 0.2);
    transform: translateY(-4px);
  }
  
  .gift-threshold__product-card.selected::after {
    content: "‚úî";
    position: absolute;
    top: 10px;
    right: 10px;
    background: {{ section.settings.card_selected_color }};
    color: white;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 700;
    animation: scaleIn 0.3s ease;
  }
  
  @keyframes scaleIn {
    from { transform: scale(0); }
    to { transform: scale(1); }
  }
  
  .gift-threshold__product-image {
    width: 100%;
    height: {{ section.settings.product_image_height }}px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 12px;
    transition: transform 0.3s ease;
  }
  
  .gift-threshold__product-card:hover .gift-threshold__product-image {
    transform: scale(1.05);
  }
  
  .gift-threshold__product-title {
    font-size: 14px;
    line-height: 1.4;
    margin-bottom: 12px;
    font-weight: 600;
    min-height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #374151;
  }
  
  .gift-threshold__variant-select,
  .gift-threshold__choose-btn {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 13px;
    background: white;
    cursor: pointer;
    margin-top: 6px;
    transition: all 0.3s ease;
  }
  
  .gift-threshold__choose-btn {
    background: {{ section.settings.button_bg_color }};
    color: {{ section.settings.button_text_color }};
    border: none;
    padding: 11px;
    font-weight: 600;
  }
  
  .gift-threshold__choose-btn:hover {
    background: {{ section.settings.button_hover_color }};
    transform: translateY(-1px);
  }
  
  .gift-threshold__selected {
    padding: 24px;
    background: linear-gradient(135deg, #f8f9fa, #f0fdf4);
    border-radius: 10px;
    margin-top: 25px;
    border: 2px solid {{ section.settings.card_selected_color }};
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.1);
  }
  
  .gift-threshold__selected h4 {
    margin: 0 0 18px 0;
    font-size: 18px;
    font-weight: 700;
    color: #065f46;
  }
  
  .gift-threshold__selected-info {
    margin-bottom: 20px;
  }

  .gift-threshold__sample-variant-section {
    background: white;
    border: 2px solid {{ section.settings.accent_color }};
    border-radius: 10px;
    padding: 22px;
    margin-top: 18px;
  }

  .gift-threshold__sample-variant-section h5 {
    margin: 0 0 14px 0;
    color: #065f46;
    font-size: 16px;
    font-weight: 700;
  }

  .gift-threshold__sample-variant-select {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 16px;
    background: white;
    margin-bottom: 18px;
    transition: all 0.3s ease;
  }

  .gift-threshold__sample-variant-select:focus {
    outline: none;
    border-color: {{ section.settings.accent_color }};
    box-shadow: 0 0 0 3px rgba({{ section.settings.accent_color | color_to_rgb | split: ',' | first }}, {{ section.settings.accent_color | color_to_rgb | split: ',' | slice: 1, 2 | join: ',' }}, 0.1);
  }
  
  .gift-threshold__button {
    padding: 16px 32px;
    background: linear-gradient(135deg, {{ section.settings.button_bg_color }}, {{ section.settings.button_hover_color }});
    color: {{ section.settings.button_text_color }};
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 200px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  .gift-threshold__button:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
  }
  
  .gift-threshold__button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: #9ca3af;
  }
  
  .gift-threshold__success {
    text-align: center;
    padding: 36px;
    background: linear-gradient(135deg, #f0fdf4, #dcfce7);
    border-radius: 12px;
    border: 2px solid {{ section.settings.card_selected_color }};
    position: relative;
    overflow: hidden;
  }
  
  .gift-threshold__success::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(16, 185, 129, 0.05), transparent);
    animation: rotate 20s linear infinite;
  }
  
  @keyframes rotate {
    to { transform: rotate(360deg); }
  }
  
  .gift-threshold__icon {
    font-size: 56px;
    margin-bottom: 18px;
    display: block;
    animation: bounce 2s infinite;
  }
  
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }
  
  .gift-threshold__success h3 {
    font-size: 26px;
    font-weight: 800;
    color: #065f46;
    margin-bottom: 14px;
    position: relative;
  }
  
  .gift-threshold__success p {
    font-size: 17px;
    color: #059669;
    line-height: 1.6;
    position: relative;
  }
  
  .gift-threshold__success-product {
    margin: 24px auto;
    padding: 18px;
    background: white;
    border: 2px solid #10b981;
    border-radius: 8px;
    display: inline-flex;
    align-items: center;
    gap: 14px;
    position: relative;
  }
  
  .gift-threshold__success-image {
    width: 56px;
    height: 56px;
    object-fit: cover;
    border-radius: 6px;
    border: 2px solid #10b981;
  }
  
  .gift-threshold__success-details {
    text-align: left;
  }
  
  .gift-threshold__success-title {
    font-size: 15px;
    font-weight: 700;
    color: #065f46;
    margin-bottom: 3px;
  }
  
  .gift-threshold__success-variant {
    font-size: 13px;
    color: #059669;
  }
  
  .gift-threshold__error {
    background: linear-gradient(135deg, #fef2f2, #fee2e2);
    border: 2px solid #fca5a5;
    border-radius: 10px;
    padding: 18px;
    color: #dc2626;
    text-align: center;
    margin-bottom: 22px;
    font-weight: 500;
  }
  
  .gift-threshold__loading {
    display: inline-flex;
    align-items: center;
    gap: 10px;
  }
  
  @media (max-width: 768px) {
    .gift-threshold {
      margin: 12px;
      padding: 20px;
    }
    
    .gift-threshold__products-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      max-height: 350px;
    }
    
    .gift-threshold__button {
      width: 100%;
    }
  }
  
  @media (max-width: 480px) {
    .gift-threshold__products-grid {
      grid-template-columns: 1fr;
    }
    
    .gift-threshold__title {
      font-size: 20px;
    }
  }
  
  @media (prefers-reduced-motion: reduce) {
    .gift-threshold__product-card,
    .gift-threshold__product-image,
    .gift-threshold__button,
    .gift-threshold__progress-bar {
      transition: none;
      animation: none;
    }
  }
</style>

<div class="gift-threshold" 
     data-threshold="{{ threshold }}"
     data-cart-total="{{ cart_total }}"
     data-sample-id="{{ sample_product.selected_or_first_available_variant.id | default: sample_product.variants.first.id }}">
  
  {%- if sample_product == blank -%}
    <div class="gift-threshold__error">
      <strong>‚ö†Ô∏è B≈ÇƒÖd konfiguracji:</strong> Nie wybrano produktu pr√≥bki. W ustawieniach sekcji wybierz produkt pr√≥bki z cenƒÖ 0 z≈Ç.
    </div>
    
  {%- elsif has_sample -%}
    <div class="gift-threshold__success">
      <div class="gift-threshold__icon">üéÅ</div>
      <h3 class="gift-threshold__title">{{ section.settings.success_title }}</h3>
      
      {%- if selected_product_image != blank or sample_info != blank -%}
        <div class="gift-threshold__success-product">
          {%- if selected_product_image != blank -%}
            <img src="{{ selected_product_image }}" 
                 alt="{{ selected_product_title | default: 'Wybrany produkt' }}"
                 class="gift-threshold__success-image">
          {%- endif -%}
          <div class="gift-threshold__success-details">
            <div class="gift-threshold__success-title">Pr√≥bka produktu:</div>
            <div class="gift-threshold__success-variant">{{ sample_info | default: selected_product_title }}</div>
          </div>
        </div>
      {%- endif -%}
      
      <p>{{ section.settings.success_message }}</p>
    </div>
    
  {%- elsif threshold_reached and has_sample == false -%}
    <div class="gift-threshold__selector">
      <h3 class="gift-threshold__title">{{ section.settings.choose_title }}</h3>
      <p style="text-align: center; color: #6b7280; margin-bottom: 20px;">
        Wybierz produkt, kt√≥rego pr√≥bkƒô chcesz otrzymaƒá bezp≈Çatnie
      </p>
      
      <input type="text" 
             class="gift-threshold__search" 
             id="product-search" 
             placeholder="{{ section.settings.search_placeholder }}">
      
      <div class="gift-threshold__products-grid" id="products-list">
        {%- assign product_count = 0 -%}
        {%- for product in collections.all.products limit: section.settings.products_limit -%}
          {%- unless product.id == sample_product.id or product.price == 0 -%}
            {%- assign product_count = product_count | plus: 1 -%}
            <div class="gift-threshold__product-card" 
                 data-product-id="{{ product.id }}"
                 data-product-title="{{ product.title | escape }}"
                 data-product-handle="{{ product.handle }}">
              
              {%- if product.featured_image -%}
                <img class="gift-threshold__product-image" 
                     src="{{ product.featured_image | image_url: width: 300 }}"
                     alt="{{ product.title | escape }}"
                     loading="lazy">
              {%- else -%}
                <div class="gift-threshold__product-image" style="background: #f3f4f6; display: flex; align-items: center; justify-content: center; color: #9ca3af;">
                  <span style="font-size: 32px;">üì¶</span>
                </div>
              {%- endif -%}
              
              <div class="gift-threshold__product-title">{{ product.title | truncate: 45 }}</div>
              
              {%- if product.variants.size > 1 -%}
                <select class="gift-threshold__variant-select" data-product-id="{{ product.id }}">
                  <option value="">Wybierz wariant</option>
                  {%- for variant in product.variants limit: 20 -%}
                    {%- if variant.available -%}
                      <option value="{{ variant.id }}" data-title="{{ variant.title | escape }}">
                        {{ variant.title }}
                      </option>
                    {%- endif -%}
                  {%- endfor -%}
                </select>
              {%- else -%}
                {%- assign first_variant = product.first_available_variant | default: product.variants.first -%}
                <button class="gift-threshold__choose-btn"
                        data-product="{{ product.title | escape }}"
                        data-variant-id="{{ first_variant.id }}"
                        data-variant-title="{{ first_variant.title | escape }}">
                  {{ section.settings.select_button_text }}
                </button>
              {%- endif -%}
            </div>
          {%- endunless -%}
        {%- endfor -%}
        
        {%- if product_count == 0 -%}
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #6b7280;">
            <span style="font-size: 48px; display: block; margin-bottom: 16px;">üì¶</span>
            <p>Brak dostƒôpnych produkt√≥w do wyboru</p>
            <p style="font-size: 14px; margin-top: 8px;">Sprawd≈∫ konfiguracjƒô kolekcji</p>
          </div>
        {%- endif -%}
      </div>
      
      <div class="gift-threshold__selected" id="selected-product" style="display: none;">
        <h4>‚úÖ Wybrany produkt: <span id="selected-name">-</span></h4>
        <button class="gift-threshold__button" 
                id="add-sample-btn"
                disabled>
          {{ section.settings.add_button_text }}
        </button>
      </div>
    </div>
    
  {%- else -%}
    <div class="gift-threshold__info">
      <h3 class="gift-threshold__title" style="text-align: center; margin-bottom: 8px;">
        üéÅ Darmowa pr√≥bka
      </h3>
      <p class="gift-threshold__message">
        {{ section.settings.message_before | replace: '[amount]', '<span class="gift-threshold__amount">' | append: remaining | money | append: '</span>' }}
      </p>
      
      {%- if section.settings.show_progress_bar -%}
        <div class="gift-threshold__progress">
          <div class="gift-threshold__progress-bar" style="width: {{ progress_percentage }}%"></div>
        </div>
        <div class="gift-threshold__progress-percent" style="text-align: center; font-size: 14px; color: #6b7280; margin-top: -10px;">
          {{ progress_percentage | round }}% do darmowej pr√≥bki
        </div>
      {%- endif -%}
    </div>
  {%- endif -%}
</div>

<script src="{{ 'gift-threshold.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Gift Threshold Enhanced",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "‚öôÔ∏è Konfiguracja g≈Ç√≥wna"
    },
    {
      "type": "product",
      "id": "sample_product",
      "label": "Produkt pr√≥bki (0 z≈Ç)",
      "info": "Wybierz produkt z cenƒÖ 0 z≈Ç i wieloma wariantami (rozmiarami pr√≥bek)"
    },
    {
      "type": "number",
      "id": "threshold",
      "label": "Pr√≥g darmowej pr√≥bki (PLN)",
      "default": 250,
      "info": "Minimalna warto≈õƒá koszyka (1-10000 PLN)"
    },
    {
      "type": "checkbox",
      "id": "show_progress_bar",
      "label": "Pokazuj pasek postƒôpu",
      "default": true
    },
    {
      "type": "range",
      "id": "products_limit",
      "label": "Maksymalna liczba produkt√≥w",
      "min": 50,
      "max": 500,
      "step": 50,
      "default": 200
    },
    {
      "type": "header",
      "content": "üìù Teksty"
    },
    {
      "type": "textarea",
      "id": "message_before",
      "label": "Komunikat przed progiem",
      "default": "Dodaj produkty za [amount] aby otrzymaƒá darmowƒÖ pr√≥bkƒô!"
    },
    {
      "type": "text",
      "id": "choose_title",
      "label": "Tytu≈Ç wyboru pr√≥bki",
      "default": "üéÅ Gratulacje! Wybierz produkt do pr√≥bki"
    },
    {
      "type": "text",
      "id": "search_placeholder",
      "label": "Placeholder wyszukiwarki",
      "default": "Szukaj produktu..."
    },
    {
      "type": "text",
      "id": "select_button_text",
      "label": "Tekst przycisku wyboru",
      "default": "Wybierz"
    },
    {
      "type": "text",
      "id": "add_button_text",
      "label": "Tekst przycisku dodania",
      "default": "Dodaj pr√≥bkƒô do koszyka"
    },
    {
      "type": "text",
      "id": "success_title",
      "label": "Tytu≈Ç po dodaniu",
      "default": "Pr√≥bka zosta≈Ça dodana!"
    },
    {
      "type": "textarea",
      "id": "success_message",
      "label": "Komunikat po dodaniu",
      "default": "Twoja darmowa pr√≥bka zostanie do≈ÇƒÖczona do zam√≥wienia."
    },
    {
      "type": "header",
      "content": "üé® Kolory"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Kolor t≈Ça",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Kolor tekstu",
      "default": "#1f2937"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Kolor akcentu",
      "default": "#dc2626"
    },
    {
      "type": "color",
      "id": "progress_bg_color",
      "label": "T≈Ço paska postƒôpu",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "progress_fill_color",
      "label": "Wype≈Çnienie paska",
      "default": "#10b981"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "T≈Ço przycisk√≥w",
      "default": "#1f2937"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Tekst przycisk√≥w",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Przycisk hover",
      "default": "#374151"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Obramowanie kart",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "card_selected_color",
      "label": "Obramowanie wybranej",
      "default": "#10b981"
    },
    {
      "type": "header",
      "content": "üìê Rozmiary"
    },
    {
      "type": "range",
      "id": "section_padding",
      "label": "Padding sekcji",
      "min": 10,
      "max": 60,
      "step": 5,
      "default": 30,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_radius",
      "label": "ZaokrƒÖglenie",
      "min": 0,
      "max": 30,
      "step": 2,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "progress_height",
      "label": "Wysoko≈õƒá paska",
      "min": 8,
      "max": 30,
      "step": 2,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "message_font_size",
      "label": "Rozmiar komunikatu",
      "min": 14,
      "max": 24,
      "step": 1,
      "default": 18,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "title_font_size",
      "label": "Rozmiar tytu≈Çu",
      "min": 18,
      "max": 32,
      "step": 2,
      "default": 28,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "text_align",
      "label": "Wyr√≥wnanie tekstu",
      "options": [
        {"value": "left", "label": "Do lewej"},
        {"value": "center", "label": "Do ≈õrodka"},
        {"value": "right", "label": "Do prawej"}
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "grid_columns",
      "label": "Kolumny siatki",
      "min": 3,
      "max": 6,
      "step": 1,
      "default": 5
    },
    {
      "type": "range",
      "id": "product_image_height",
      "label": "Wysoko≈õƒá obrazka",
      "min": 80,
      "max": 200,
      "step": 10,
      "default": 120,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "grid_max_height",
      "label": "Max wysoko≈õƒá listy",
      "min": 300,
      "max": 600,
      "step": 50,
      "default": 450,
      "unit": "px"
    }
  ],
  "presets": [
    {
      "name": "Gift Threshold Enhanced",
      "settings": {
        "threshold": 250,
        "show_progress_bar": true,
        "message_before": "Dodaj produkty za [amount] aby otrzymaƒá darmowƒÖ pr√≥bkƒô!",
        "choose_title": "üéÅ Gratulacje! Wybierz produkt do pr√≥bki",
        "success_title": "Pr√≥bka zosta≈Ça dodana!",
        "success_message": "Twoja darmowa pr√≥bka zostanie do≈ÇƒÖczona do zam√≥wienia."
      }
    }
  ],
  "templates": ["cart"]
}
{% endschema %}